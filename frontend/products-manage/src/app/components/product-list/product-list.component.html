<div class="container">
  <div class="header">
    <h1>Carrito de Compras</h1>
  </div>

  @if (isLoading) {
    <p>Cargando productos...</p>
  } @else if (errorMessage) {
    <div class="error-message">{{ errorMessage }}</div>
  } @else {
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Nombre</th>
          <th>Precio</th>
          <th>Stock Disponible</th>
          <th>Cantidad</th>
          <th>Acci√≥n</th>
        </tr>
      </thead>
      <tbody>
        @for (product of products; track product.id) {
          <tr>
            <td>{{ product.attributes.id }}</td>
            <td>{{ product.attributes.name }}</td>
            <td>{{ product.attributes.price | currency }}</td>
            <td>{{ product.attributes.available_stock }}</td>
            <td>
              <input 
                type="number" 
                class="quantity-input"
                [(ngModel)]="product.purchaseQuantity"
                [max]="product.attributes.available_stock"
                min="0"
              />
            </td>
            <td class="actions">
              <button 
                (click)="purchase(product)" 
                class="btn btn-success"
                [disabled]="!product.purchaseQuantity || product.purchaseQuantity <= 0 || product.purchaseQuantity > product.attributes.available_stock">
                Comprar
              </button>
            </td>
          </tr>
        }
      </tbody>
    </table>
  }
</div>